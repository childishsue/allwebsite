<style>
  .hidden {
    display: none
  }

  .sumitonly {
    display: block !important
  }

  /* .maintainonly{} */
</style>
<section id="secHeader">
		<img src="../../img/lbc/favicon-01.png">
		<li class="{auth}"><a href="/member_center"><img src="../../img/lbc/icon-13.png" alt="about">會員中心</a></li>
		<li class="{auth}"><a href="/member"><img src="../../img/lbc/icon-11.png" alt="editfile">修改資料</a></li>
		<li class="active {auth}"><a href="/store"><img src="../../img/lbc/icon-07.png" alt="verify">買進P點</a></li>
		<li class="{auth}"><a href="/transfer"><img src="../../img/lbc/icon-08.png" alt="transfer">資產轉移</a></li>
		<li class="{auth}"><a href="/withdraw"><img src="../../img/lbc/icon-09.png" alt="withdraw">賣出P點</a></li>
		<li class="{auth}"><a href="/record_store"><img src="../../img/lbc/icon-10.png" alt="account">交易紀錄</a></li>
		<!--<li class="{auth}"><a href="/customer_service"><img src="../../img/lbc/icon-12.png" alt="message">客服中心</a></li>-->
	</section>

<section id="mobileSecHeader">
		<li class="{auth}"><a href="/member_center"><img src="../../img/lbc/icon-13.png" alt="about"></a></li>
		<li class="{auth}"><a href="/member"><img src="../../img/lbc/icon-11.png" alt="editfile"></a></li>
		<li class="active {auth}"><a href="/store"><img src="../../img/lbc/icon-07.png" alt="verify"></a></li>
		<li class="{auth}"><a href="/transfer"><img src="../../img/lbc/icon-08.png" alt="transfer"></a></li>
		<li class="{auth}"><a href="/withdraw"><img src="../../img/lbc/icon-09.png" alt="withdraw"></a></li>
		<li class="{auth}"><a href="/record_store"><img src="../../img/lbc/icon-10.png" alt="account"></a></li>
		<!--<li class="{auth}"><a href="/customer_service"><img src="../../img/lbc/icon-12.png" alt="message"></a></li>-->
	</section>

<section id="mainWrap" class="wrapper style2">
  <div class="secWrap">
    <!-- 上半部 -->
    <div id="memTitle">
      <div class="title">
        <img src="../../img/lbc/icon-07.png" alt="">
        <h1>買進P點</h1>
      </div>
      <div class="Signout">
        <a href="index.html">
          <button class="Signout-button">
            登出
          </button>
        </a>
      </div>
    </div>
    <!-- 下半部 -->
    <div id="editList">
      <div class="col-md-12 margin-top-bottom-15px">
        <div class="agileinfo-grap-2 background-white margin-top-2">
          <div class="col-md-7">
            <form class="member_form" action="/ajax/edit" method="POST">
              <div id="typeAccount" class="input-group-1 input-group-2">
                <h2 class="style-2">登入帳號 :</h2>
                <input type="text" style="color:black; border-color:transparent;" required="" disabled
                  value="{user-account}" class="input-2">
              </div>
              <div id=" " class="input-group input-group-2">
                <h2 class="style-2">電子錢包 :</h2>
                <input type="text" style="color:black; border-color:transparent;" required="" disabled
                  value="{user-wallet}" class="input-2">
              </div>
            </form>
            <form action="/ajax/store" method="POST" class="store_form">
              <div id="choosesolu">
                <div class="input-group">
                  <span class="sumitonly">
                    <h3 style="margin-bottom:2%;">選擇儲值方式</h3>
                    <h2>儲值方式&emsp;</h2>
                    <p>
                      <span>ATM</span><span style="color:red; font-weight:bold;font-size: .9em;">1000~100000</span>
                      <span>超商</span><span style="color:red; font-weight:bold;font-size: .9em;">1000~20000</span>
                    </p>
                    <select id="store-options" name="src_id">
                      <!-- @payment-item -->
                      <option value="{id}">{text}</option>
                      <!-- <input type="radio" name="src_id" value="{id}" data-target="{percent}" data-note="{note}" -->
                      <!-- style="width:20px;">{text} -->
                      <!-- @payment-item -->
                    </select>
                  </span>
                </div>

                <div class="input-group">
                  <h2>儲值目標</h2>
                  <input type="hidden" name="tar_id" value="1">
                  <select id="store-where">
                    <option value="1" name="tar_id" type="">電子錢包</option>
                  </select>
                </div>
                <div class="input-group-1">
                  <h2>輸入金額</h2>
                  <input type="text" id="amount" name="total" style="color:black" valuex="1001">
                </div>

                <div id="saveChange">
                  <button type="button" class="submit btn Signout-button">
                    儲值
                  </button>
                  <span class="hidden">維護中</span>
                </div>
              </div>
            </form>
          </div>

          <div id="warning">
            <h3>注意事項:</h3>
            <strong>
              <p>同一帳戶/家庭/戶籍地址/電話號碼/IP地址/共享電腦/網路環境，視為同一會員，若查詢到多個帳號、同一IP，且交代不清者，一律視為詐騙帳號停權處分。</p>
              <p>秉持維持對客戶最高服務品質，以及風險控管，每位會員交易綁定唯一銀行帳戶，若有使用第2組以上帳號進行儲值皆須提供證明。</p>
              <!-- <p>申請點數需1000點以上，請務必確認填寫之帳號，若提供的帳號錯誤，恕本公司無法負責。</p> -->
              <p>會員首次填寫帳號後，即永久綁定，恕不任意變更。</p>
              <p>有效買賣不包含雙邊互押等情形，本公司風險控管部門皆會審核，請勿違反規定。各別活動提領規定。</p>

              <p>如利用本平台進行任何洗錢詐騙行為，本公司有權利審核會員帳戶或永久終止會員服務，不另行通知。</p>
            </strong>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="wthree-copyright">
        <p>{web-foot}</p>
      </div>
    </div>
  </div>

</section>

<script>
  $(function () {
    $('.store_form').find('.submit').onClick(function (data) {
      if (data.code) {
        // fail
        swal({
          title: data.text,
          html: true,
          customClass: 'swalPopup'
        });
      } else {
        swal({
          title: data.text,
          html: true,
          customClass: 'swalPopup'
        }, function () {
          if (data.html) {
            // credit card redirect
            window.open('/raw/' + data.html, '_blank');
          } else {
            window.location = 'record_store';
          }
        });
      }
      $(this).button('reset');
    }, function () {
      $(this).button('loading');
    });
  });
</script>
<script>
  jQuery.fn.extend({
    feeTest: function () {

      $(this).each(function () {
        var m_div = $('<div style="color: white;">' +
          '<span style="font-size: 20px;font-weight: :bold;">可得點數: </span>' +
          '<span style="font-size: 20px;font-weight:bold;color: #ffde00;margin-right: 10px;"></span>' +
          '<span>服務費$ </span>' +
          '<span></span>' +
          '</div>');
        var form = $(this).closest('form');
        var div = $(this).closest('tr').clone();
        $(div).find('th').text('可得點數');
        $(div).find('td').text('');
        $(div).find('td').append(
          '<input type="text" readonly="readonly" style="width: 100px;padding-left:5px;" value=""/>  服務費$ <span></span>'
        );

        $(form).find('[name=src_id]').on('click', function () {
          $(form).find('[name=total]').trigger('input');
        })

        $(this).on('input', function () {
          var srid = $(this).closest('form').find('[name=src_id]');
          var type = srid.prop('nodeName');

          if (type == 'SELECT') {
            var percent = srid.find('option:selected').attr('data-target');
          } else {
            percent = srid.filter(':checked').attr('data-target');
          }
          if (parseInt(percent)) {
            var a = $(this).val();
            var b = Math.ceil(a * percent / 100);
            var c = a - b;
            if (type == 'SELECT') {
              $(m_div).find('span').eq(1).text(c);
              $(m_div).find('span').eq(3).text(b);
              $(this).after(m_div);
              $(m_div).show();
              $(div).hide();
            } else {
              $(div).find('input').val(c);
              $(div).find('span').text(b);
              $(this).closest('tr').after(div);
              $(div).show();
              $(m_div).hide();
            }
          } else {
            $(div).hide();
            $(m_div).hide();
          }
        }).trigger('input');
      });
    }
  });
  $('[name=total]').feeTest();
  $('label').find('[name=src_id]').on('click', function () {
    note = $(this).attr('data-note');
    $(this).closest('span').find('p').text(note).prepend(($(this).val() == 5) ?
      '<a class="label label-warning small" style="left: 15px" href="/card"><i class="fa fa-plus-circle" aria-hidden="true"></i> 綁定信用卡</a> ' :
      '').show();
  }).eq(0).trigger('click');
  $('select[name=src_id]').change(function () {
    note = $(this).find('option:selected').attr('data-note');
    $(this).closest('.c_store').find('p').text(note).prepend(($(this).val() == 5) ?
      '<a class="label label-warning small" style="left: 15px" href="/card"><i class="fa fa-plus-circle" aria-hidden="true"></i> 綁定信用卡</a> ' :
      '').show();
  }).trigger('change');
</script>